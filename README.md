# Supermartingale Certificates for Quantitative Omega-regular Verification and Control

## Table of Contents

- [Introduction](#introduction)
- [Features](#features)
- [Getting Started](#getting-started)
  - [Installing requirements](#installing-requirements)
  - [Running the System using CLI](#running-the-system-using-cli)
  - [Running the System using a Python Script](#running-the-system-using-a-python-script)
  - [Design your own example](#design-your-own-example)
  - [Interpreting the results](#interpreting-the-results)
  - [Reproducing Experimental Results](#reproducing-experimental-results)
- [Docker Usage Guide](#docker-usage-guide)
- [Citation](#citation)


## Introduction 
This repository contains the artifact of the paper titled 
"Supermartingale Certificates for Quantitative Omega-regular Verification and Control", 
which is proposed a novel approach for quantitative $\omega$-regular verification and control of infinite-state stochastic systems.

For the Artifact Evaluation version of this project, 
please refer to the [Instruction.md](./Documents/Instruction.md) for detailed setup and execution instructions.


## Features

- Supermartingale Certificates – Implements LDBSM certificates for probabilistic verification and control.
- Quantitative $\omega$-Regular Verification – Extends beyond reachability and safety to general $\omega$-regular properties.
- Template-Based Synthesis – Uses polynomial templates and SMT solvers to automate certificate generation.
- Polynomial Stochastic Systems – Supports verification and control for polynomial stochastic dynamical systems.


## Getting Started

To run the system and execute a benchmark, You have two options:
1. Using a python script
2. Using the command line

You can use the provided Docker image to run the system, or you can install the required packages and run the system on your local machine.

### Installing requirements

We used `python 3.12.5` for our experiments. After installing python, you can install the required packages using the following command in your environment:

```bash
pip install -r requirements.txt
```

You can easily install the Z3 solver using the following command:

```bash
pip install z3-solver
```

- For more information on how to install Z3, you can visit the [Z3 GitHub page](https://github.com/Z3Prover/z3).
- To download the MathSAT, you can visit the [MathSat website](https://mathsat.fbk.eu/download.html).
- Also for more information on PolyQEnt, you can visit the [PolyQEnt GitHub page](https://github.com/ChatterjeeGroup-ISTA/polyqent).


### Running the System using CLI

To run the benchmarks using the command line, you can use the following command:

```bash
python3 -m system --input <path_to_your_benchmark> [--iterations <number_of_iterations>]
```
The default value for the number of iterations is 1.

If you want to run all the benchmarks in a directory at once, you can use the system's bulk mode. 
For this purpose, for `--input` argument, you should provide the path to the directory containing the benchmarks, and the system would run all the benchmarks in that directory.
By default, all results are saved in the `benchmark_results.txt`, which can be modified by using the `--output` argument:

```bash
python3 -m system --input <path_to_your_benchmark_directory> [--output <output_file_name>]
```
Note that in this case, the `--iterations` argument is always set to 1.

### Running the System using a python script

To run the benchmarks using a python script, you can use the `runner_check.py` script, which is:

```python
from system import benchmark_runner

if __name__ == "__main__":
    config_file = "./benchmark/random_walk_verification_3.json"

    benchmark_runner(config_file, iterations=1)
```

To run different benchmarks, you just need to modify _config_file_ in the script.


### Design your own example

You can design your own example by following the system's input format. You can find more information about the system's input format in the [input format document](./Documents/input_format.md).

Also, you can find more examples of the system's input in the `./benchmark` directory.


### Interpreting the results

To understand the output generated by the system, 
you can refer to the [output format document](./Documents/output_format.md).


### Reproducing Experimental Results

To reproduce the experimental results, 
you can use the `make benchmark` command or use the CLI interface and run all the benchmarks in `./benchmark` directory, 
by using `python3 -m system --input ./benchmark` command.


## Docker Usage Guide

If you need a step-by-step guide on how to interact with the docker image, you can refer to the [Docker Usage Guide](./Documents/docker.md) to learn how to build, run, save, and load the docker image for this project.
This document provides detailed instructions on how to use docker. To install docker, you can visit the [Docker website](https://www.docker.com/get-started/).

> [!TIP]
> You can build the project's docker image using `make docker` command.

## Citation

If you use this code or refer to our method in your work, please cite our paper:

```bibtex
@InProceedings{OmegaRegularStochCert,
  author="Henzinger, Thomas A.
  and Mallik, Kaushik
  and Sadeghi, Pouya
  and {\v{Z}}ikeli{\'{c}}, {\DJ}or{\dj}e",
  editor="Piskac, Ruzica
  and Rakamari{\'{c}}, Zvonimir",
  title="Supermartingale Certificates for Quantitative Omega-Regular Verification and Control",
  booktitle="Computer Aided Verification",
  year="2025",
  publisher="Springer Nature Switzerland",
  address="Cham",
  pages="29--55",
  abstract="We present the first supermartingale certificate for quantitative {\$}{\$}{\backslash}omega {\$}{\$}$\omega$-regular properties of discrete-time infinite-state stochastic systems. Our certificate is defined on the product of the stochastic system and a limit-deterministic B{\"u}chi automaton that specifies the property of interest; hence we call it a limit-deterministic B{\"u}chi supermartingale (LDBSM). Previously known supermartingale certificates applied only to quantitative reachability, safety, or reach-avoid properties, and to qualitative (i.e., probability 1) {\$}{\$}{\backslash}omega {\$}{\$}$\omega$-regular properties.We also present fully automated algorithms for the template-based synthesis of LDBSMs, for the case when the stochastic system dynamics and the controller can be represented in terms of polynomial inequalities. Our experiments demonstrate the ability of our method to solve verification and control tasks for stochastic systems that were beyond the reach of previous supermartingale-based approaches.",
  isbn="978-3-031-98679-6"
}
```

